<h1>All Products</h1>
<% if (products && products.length > 0) { %>
    <div class="product-grid">
        <% products.forEach(product => { %>
            <div class="product-card">
                <img src="<%= product.imageUrl %>" alt="<%= product.name %>" style="width:150px; height:auto;">
                <h2><a href="/products/<%= product._id %>"><%= product.name %></a></h2>
                <p class="price">$<%= product.price.toFixed(2) %></p>
                <p>Category: <%= product.category %></p>
                <p>Sold by: <%= product.seller ? product.seller.username : 'N/A' %></p>
                 <% if (product.seller && product.seller.whatsappNumber) { %>
                    <% const waMessage = encodeURIComponent(`Halo ${product.seller.username}, saya tertarik dengan produk Anda "${product.name}" yang ada di marketplace.`); %>
                    <% const whatsappLink = `https://wa.me/${product.seller.whatsappNumber}?text=${waMessage}`; %>
                    <a href="<%= whatsappLink %>" target="_blank" class="whatsapp-button">Contact Seller via WhatsApp</a>
                <% } %>
            </div>
        <% }); %>
    </div>
<% } else { %>
    <p>No products found.</p>
<% } %>